p8105_hw2_lq2250
================
Lanlan_Qing
2024-09-25

# Load libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(dplyr)
library(readxl)
```

# Problem 1

## Read and clean the data

``` r
data_nyc_transit = read_csv("data_hw2/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
                            na = c("NA", ".", "")) |>
  janitor::clean_names() |>
  select(line:entry, vending, ada)|>
  mutate(entry = 
           case_match(
             entry,
             "YES" ~ TRUE,
             "NO" ~ FALSE),
         across(route1:route11, as.character))|>
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name",
    names_prefix = "route"
  )
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
view(data_nyc_transit)
glimpse(data_nyc_transit)
```

    ## Rows: 20,548
    ## Columns: 10
    ## $ line              <chr> "4 Avenue", "4 Avenue", "4 Avenue", "4 Avenue", "4 A…
    ## $ station_name      <chr> "25th St", "25th St", "25th St", "25th St", "25th St…
    ## $ station_latitude  <dbl> 40.66040, 40.66040, 40.66040, 40.66040, 40.66040, 40…
    ## $ station_longitude <dbl> -73.99809, -73.99809, -73.99809, -73.99809, -73.9980…
    ## $ entrance_type     <chr> "Stair", "Stair", "Stair", "Stair", "Stair", "Stair"…
    ## $ entry             <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE…
    ## $ vending           <chr> "YES", "YES", "YES", "YES", "YES", "YES", "YES", "YE…
    ## $ ada               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL…
    ## $ route_number      <chr> "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "…
    ## $ route_name        <chr> "R", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "R", NA…

## Q1:

*Write a short paragraph about this dataset – explain briefly what
variables the dataset contains, describe your data cleaning steps so
far, and give the dimension (rows x columns) of the resulting dataset.
Are these data tidy?* <br>

**Answer:** <br>

1.variables: <br>

- line, station_name, station_latitude, station_longitude,
  entrance_type, entry, vending, ada, route_number, route_name

2.description of my data cleaning:<br>

- In the data cleaning process, I utilized the *janitor::clean_names()*
  to standardize column names, making them more manageable.

- I then use *select()* to select relevant columns, specifically those
  from line to entry, along with vending and ada compliant. The entry
  variable was transformed from character values (“YES” and “NO”) to
  logical values (TRUE and FALSE) using *case_match()*.

- Additionally, the route columns (from route1 to route11) were
  converted to numeric format using *mutate(across())*. Then I reshaped
  the data using *pivot_longer()* to transform the wide format of route
  columns into a long format, making the dataset more suitable for
  viewing.

- As a result of these steps, the dataset has dimensions of 20548 rows
  and 10 columns.

3.The resulting dataset is considered tidy as each variable name is
clear enough for analysis, easy-to-read, and reasonably categorized.
However, further data tidy process could be done depending on the use of
the dataset, such as separating data into several tables by different
lines/entrance types/station names etc..

## Q2:

*Answer the following questions using these data:*<br>

- *How many distinct stations are there? Note that stations are
  identified both by name and by line (e.g. 125th St 8th Avenue; 125st
  Broadway; 125st Lenox); the distinct function may be useful here.*<br>

**Coding**

``` r
station_type = data_nyc_transit |>
  count(line, station_name)
```

**Answer**

There are 465 distinct stations.

<br>

- *How many stations are ADA compliant?*

**Coding**

``` r
ada_compliant = data_nyc_transit |>
  distinct(line, station_name, ada) |>
  filter (ada == TRUE)
```

**Answer**

There are 84 stations that are ADA compliant.

<br>

- *What proportion of station entrances / exits without vending allow
  entrance?*

**Coding**

``` r
prop_no_entrance = data_nyc_transit |>
  count(vending)|>
  mutate(proportion = n/dim(data_nyc_transit)[1])
```

**Answer**

The proportion of station entrances without vendig allow entrance is
0.0979657.

<br>

## Q3:

*Reformat data so that route number and route name are distinct
variables. How many distinct stations serve the A train? Of the stations
that serve the A train, how many are ADA compliant?*

**Coding**

``` r
distinct_serve_A = data_nyc_transit |>
  distinct(line, station_name,route_name)|>
  filter(route_name == "A")

serve_A_ada = data_nyc_transit |>
  filter(route_name == "A")|>
  count(route_name, ada)
```

**Answer**

There are 60 distinct stations that serve A train. Of the stations that
serve the A train, 107 are ADA compliant.

# Problem 2

## Q1

**Read and clean the Mr. Trash Wheel sheet**

``` r
mr_trash_wheel = read_excel("data_hw2/202309 Trash Wheel Collection Data.xlsx", 
                            sheet = "Mr. Trash Wheel",
                            range = "A2:N586", 
                            na = c("NA", ".",""))|>
  janitor::clean_names()|>
  select(month:homes_powered)|>
  mutate(across(sports_balls, as.integer),
         year = as.double(year),
         wheel = "mr")
```

**Read and clean the Professor Trash Wheel Sheet**

``` r
professor_trash_wheel = read_excel("data_hw2/202309 Trash Wheel Collection Data.xlsx", 
                            sheet = "Professor Trash Wheel",
                            range = "A2:M108",
                            na = c("NA", ".",""))|>
  janitor::clean_names()|>
  select(month:homes_powered)|>
  mutate(sports_balls = NA, .after = "wrappers",
         across(sports_balls, as.integer),
         wheel = "professor")
```

**Read and clean the Gwynnda Trash Wheel Sheet**

``` r
gwynnda_trash_wheel = read_excel("data_hw2/202309 Trash Wheel Collection Data.xlsx", 
                            sheet = "Gwynnda Trash Wheel",
                            range = "A2:L157",
                            na = c("NA", ".",""))|>
  janitor::clean_names()|>
  select(month:homes_powered)|>
  mutate(sports_balls = NA, .after = "wrappers",
         across(sports_balls, as.integer)) |>
  mutate(glass_bottles = NA, .after = "cigarette_butts",
         wheel = "gwynnda")
```

**Combine three sheets**

``` r
trash_wheel_sheet = bind_rows(mr_trash_wheel, professor_trash_wheel, gwynnda_trash_wheel)|>
  relocate(wheel)
```

*Write a paragraph about these data; you are encouraged to use inline R.
Be sure to note the number of observations in the resulting dataset, and
give examples of key variables. For available data, what was the total
weight of trash collected by Professor Trash Wheel? What was the total
number of cigarette butts collected by Gwynnda in June of 2022?*<br>

1.The number of observations is 845.

2.Key variables are: wheel, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, homes_powered

3.Total weight of trash collected by Professor Trash Wheel is: 216.26
tons.

4.Total number of cigarette butts collected by Gwynnda in June of 2022
is 18120
